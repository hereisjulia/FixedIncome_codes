library(readxl)
library(stringr)
library(tidyverse)
library(writexl)

funds <- read_excel("E:/MQM_Courses/AllCase/DataCompetition/Funds Dashboard_OptimizingRisk/Fund List and Performance.xlsx")
View(funds)
funds <- arrange(funds, desc(`Tot Ret 1Y`))

nrow(funds)
#save the name, return only
return <- cbind(funds$Name, funds[str_detect(names(funds), "Ret")])[-7]
names(return) <- c("Name", "1", "3", "6","12","36")
return <- pivot_longer(return, cols = -1, names_to = "month", values_to = "return")

write_xlsx(return, path = "E:/MQM_Courses/AllCase/DataCompetition/Funds Dashboard_OptimizingRisk/fund_return.xlsx")


# longer the types
types <- cbind(Name = funds$Name, funds[str_detect(names(funds), "Focus")], Strategy = funds$`Fund Strategy`)
types <- pivot_longer(types, cols = -1, names_to = "type", values_to = "content")
write_xlsx(types, path = "E:/MQM_Courses/AllCase/DataCompetition/Funds Dashboard_OptimizingRisk/fund_types.xlsx")
