settle <- DATE(2024,01,19)
sp[, maturity := as.Date2(maturity)]
sp[, ttm := as.numeric(maturity - settle)/365]
sp[, spot := zcb.yield(sp_pmid, ttm)]
# start question 19
ci <- fread("./datas/midterm/midterm_ci.csv")
settle <- DATE(2024,01,19)
ci[, maturity := as.Date2(maturity)]
ci[, ttm := as.numeric(maturity - settle)/365]
ci[, spot := zcb.yield(ci_pmid, ttm)]
Y.reg.ci <- lm(spot ~ ttm + I(ttm^2) + I(ttm^3) + I(ttm^4) + I(ttm^5), data = ci)
adj.r2.ci <- summary(Y.reg.ci)$adj.r.squared
# answer:
round(adj.r2.ci, 4)
Y.reg.sp <- lm(spot ~ ttm + I(ttm^2) + I(ttm^3) + I(ttm^4) + I(ttm^5), data = ci)
Y.reg.sp <- lm(spot ~ ttm + I(ttm^2) + I(ttm^3) + I(ttm^4) + I(ttm^5), data = sp)
summary(Y.reg.sp)
summary(Y.reg.sp)$adj.r.squared
adj.r2.sp <- summary(Y.reg.sp)$adj.r.squared
# answer:
adj.r2.sp
# answer:
round(adj.r2.sp, 4)
# start question 21
mid.61 <- fread("./datas/midterm/midterm_Q2_61.csv")
# start question 21
Q12
# start question 21
mid.61 <- fread("./datas/midterm/midterm_Q2_61.csv")
settle <- DATE(2024,01,19)
date <- coupons.dates(settle, mid.61$maturity, freq)
CFs <- data.table( date = coupons.dates(settle, mid.61$maturity, freq))
face <- 100
CFs[, coupon := face * coupon]
View(CFs)
N <- nrow(CFs)
CFs[, principal := c(rep(0, N-1), face)]
View(CFs)
CFs[, ttm := as.numeric(date - settle)/365]
View(CFs)
# start question 21
mid.61 <- fread("./datas/midterm/midterm_Q2_61.csv")
settle <- DATE(2024,01,19)
face <- 100
CFs <- data.table( date = coupons.dates(settle, mid.61$maturity, freq))
N <- nrow(CFs)
CFs[, ttm := as.numeric(date - settle)/365]
CFs[, coupon := face * coupon]
CFs[, principal := c(rep(0, N-1), face)]
CFs$ci_spot <- predict(Y.reg.ci, newdata = CFs$ttm)
CFs$ci_spot <- predict(Y.reg.ci, newdata = CFs[,"ttm"])
CFs$sp_spot <- predict(Y.reg.sp, newdata = CFs[,"ttm"])
CFs[, ci.pv := zcb.price(ci_spot, ttm, freq)]
View(CFs)
CFs[, ci.pv := zcb.price(ci_spot, ttm, freq)/100 * coupon]
View(CFs)
CFs[, sp.pv := zcb.price(sp_spot, ttm, freq)/100 * principal]
sum(CFs$ci.pv)
sum(CFs$ci.pv) + sum(CFs$sp.pv)
View(CFs)
sum(CFs$ci.pv) + sum(CFs$sp.pv)
PV.61 <- sum(CFs$ci.pv) + sum(CFs$sp.pv)
# answer:
PV.61
# answer:
round(PV.61, 4)
ggplot(CI, aes(x = ttm, y = Z))+
geom_point()
autoplot()
librar(ggplot2)
library(ggplot2)
autoplot(tr)
ts
5300*12
6000*12
library(data.table)
library(data.table)
library(tidyverse)
library(jrvFinance)
library(jrvFinance)
fread("./datas/IndividualAssignment3_cstrips")
fread("./datas/IndividualAssignment3_cstrips")
fread("./datas/IndividualAssignment3_cstrips.csv")
settle <- as.Date("2024-01-10")
library(data.table)
library(data.table)
library(tidyverse)
library(jrvFinance)
library(jrvFinance)
CI
settle <- as.Date("2024-01-10")
t1 <- as.Date("2024-08-15")
t2 <- as.Date("2025-02-15")
t1 <- as.numeric(as.Date("2024-08-15")-settle)/365
t2 <- as.numeric(as.Date("2025-02-15")-settle)/365
CI
# start question 1
CI <- fread("./datas/IndividualAssignment3_cstrips.csv")
CI
zcb.price <- function(zcb.yield, ttm, freq = 2){
return(100 /(1 - zcb.yield /freq) ^ (freq*ttm))
}
zcb.yield <- function(zcb.price, ttm, freq = 2){
return(freq * ((100 /zcb.price) ^(1 /(freq*ttm))-1))
}
CI
CI[, ttm := as.numeric(maturity - as.IDate(settle))/365]
zcb.yield(CI$price, CI$ttm, freq =2)
CI[, z := zcb.yield(CI$price, CI$ttm, freq =2)]
freq <- 2
CI
CI[ttm == t1]
CI[ttm == t1]$z
fv.t1
fv.t1 <- (1+ CI[ttm == t1]$z/freq) ^ (freq*t1)
fv.t1
fv.t2 <- (1+ CI[ttm == t2]$z/freq) ^ (freq*t2)
fv.t2
fv.t2 <- (1+ CI[ttm == t2]$z/freq) ^ (freq*t2)
# FV.t2 = fv.t1 * (1 + fwr/freq) ^ (freq * (t2-t1))
fwr.t1_2 <- freq * ((fv.t2/fv.t1)^(1/freq*(t2-t1))-1)
fwr.t1_2
# start question 1
settle <- as.Date("2024-01-10")
freq <- 2
CI <- fread("./datas/IndividualAssignment3_cstrips.csv")
CI[, ttm := as.numeric(maturity - as.IDate(settle))/365]
CI[, z := zcb.yield(CI$price, CI$ttm, freq)]
t1 <- as.numeric(as.Date("2024-08-15")-settle)/365
t2 <- as.numeric(as.Date("2025-02-15")-settle)/365
## invest 1 dollar from t0 to t1 to t2
fv.t1 <- (1+ CI[ttm == t1]$z/freq) ^ (freq*t1)
fv.t2 <- (1+ CI[ttm == t2]$z/freq) ^ (freq*t2)
# FV.t2 = fv.t1 * (1 + fwr/freq) ^ (freq * (t2-t1))
fwr.t1_2 <- freq * ((fv.t2/fv.t1)^(1/freq*(t2-t1))-1)
fwr.t1_2
CI
# start question 1
settle <- as.Date("2024-01-10")
freq <- 4
CI <- fread("./datas/IndividualAssignment3_cstrips.csv")
CI[, ttm := as.numeric(maturity - as.IDate(settle))/365]
CI[, z := zcb.yield(CI$price, CI$ttm, freq)]
t1 <- as.numeric(as.Date("2024-08-15")-settle)/365
t2 <- as.numeric(as.Date("2025-02-15")-settle)/365
## invest 1 dollar from t0 to t1 to t2
fv.t1 <- (1+ CI[ttm == t1]$z/freq) ^ (freq*t1)
fv.t2 <- (1+ CI[ttm == t2]$z/freq) ^ (freq*t2)
# FV.t2 = fv.t1 * (1 + fwr/freq) ^ (freq * (t2-t1))
fwr.t1_2 <- freq * ((fv.t2/fv.t1)^(1/freq*(t2-t1))-1)
fwr.t1_2
# start question 1
settle <- as.Date("2024-01-10")
freq <- 2
CI <- fread("./datas/IndividualAssignment3_cstrips.csv")
CI[, ttm := as.numeric(maturity - as.IDate(settle))/365]
CI[, z := zcb.yield(CI$price, CI$ttm, freq)]
t1 <- as.numeric(as.Date("2024-08-15")-settle)/365
t2 <- as.numeric(as.Date("2025-02-15")-settle)/365
## invest 1 dollar from t0 to t1 to t2
fv.t1 <- (1+ CI[ttm == t1]$z/freq) ^ (freq*t1)
fv.t2 <- (1+ CI[ttm == t2]$z/freq) ^ (freq*t2)
# FV.t2 = fv.t1 * (1 + fwr/freq) ^ (freq * (t2-t1))
fwr.t1_2 <- freq * ((fv.t2/fv.t1)^(1/freq*(t2-t1))-1)
fwr.t1_2
# FV.t2 = fv.t1 * (1 + fwr/freq) ^ (freq * (t2-t1))
fwr.t1_2 <- freq * ((fv.t2/fv.t1)^(1/freq*(t2-t1))-1)
## invest 1 dollar from t0 to t1 to t2
fv.t1 <- (1+ CI[ttm == t1]$z/freq) ^ (freq*t1)
fv.t2 <- (1+ CI[ttm == t2]$z/freq) ^ (freq*t2)
# FV.t2 = fv.t1 * (1 + fwr/freq) ^ (freq * (t2-t1))
fwr.t1_2 <- freq * ((fv.t2/fv.t1)^(1/freq/(t2-t1))-1)
fwr.t1_2
library(quantmod)
library(quantmod)
# start question 2
sofr = getSymbols('SOFR',src='FRED',auto.assign=FALSE)
sofr = na.omit(sofr)
sofr = as.data.table(sofr)
names(sofr) = c('Date','SOFR')
sofr[, SOFR := SOFR/100]
head(sofr)
t2 <- as.Date("2023-12-31")
t1 <- as.Date("2023-09-01")
t2 <- as.Date("2023-12-31")
View(sofr)
t2 -t1
D <- as.numeric(t2 - t1)
if (!(t1 %in% sofr$Date)){
tmp = data.table(Date = t1, SOFR = NA)
sofr = rbind(sofr,tmp)
}
if (!(t2 %in% sofr$Date)){
tmp = data.table(Date = t2, SOFR = NA)
sofr = rbind(sofr,tmp)
}
setorder(sofr, Date)
sofr[, SOFR:= na.locf(SOFR)]
sofr
data <- sofr[Date >= t1 & Date <= t2]
data
data[, di := c(as.numeric(diff(Date)), 0)]
data
data[, gross_daily_rate := 1 + SOFR*di/360]
data[, cum_prod := cumprod(gross_daily_rate)]
tail(data)
SOFR_average <- round((data[(.N -1),]$cum_prod[1] -1) * 100 * 360 /D, 5)
SOFR_average
Interest <- 2000000 * (SOFR_average/100) * as.numeric(t2-t1) / 360
round(Interest, 2)
Interest <- 2000000 * (SOFR_average/100 + 0.02) * as.numeric(t2-t1) / 360
round(Interest, 2)
# start question 3
t1 <- as.Date("2023-06-21")
t2 <- as.Date("2023-09-20")
if (!(t1 %in% sofr$Date)){
tmp = data.table(Date = t1, SOFR = NA)
sofr = rbind(sofr,tmp)
}
if (!(t2 %in% sofr$Date)){
tmp = data.table(Date = t2, SOFR = NA)
sofr = rbind(sofr,tmp)
}
data <- sofr[Date >= t1 & Date <= t2]
t1 <- as.Date("2023-06-21")
t2 <- as.Date("2023-09-20")
sofr = getSymbols('SOFR',src='FRED',auto.assign=FALSE)
sofr = na.omit(sofr)
sofr = as.data.table(sofr)
names(sofr) = c('Date','SOFR')
sofr[, SOFR := SOFR/100]
if (!(t1 %in% sofr$Date)){
tmp = data.table(Date = t1, SOFR = NA)
sofr = rbind(sofr,tmp)
}
if (!(t2 %in% sofr$Date)){
tmp = data.table(Date = t2, SOFR = NA)
sofr = rbind(sofr,tmp)
}
data <- sofr[Date >= t1 & Date <= t2]
data[, di := c(as.numeric(diff(Date)), 0)]
data[, gross_daily_rate := 1 + SOFR*di/360]
D <- sum(data$di)
data[, cum_prod := cumprod(gross_daily_rate)]
R <- (data[(.N -1)]$cum_prod[1] - 1) * 360/D
R
R <- (data[(.N -1)]$cum_prod[1] - 1) * 360/D *100
round(R, 4)
SR3_final <- 100 - R
round(SR3_final, 4)
# start question 4
SR3fur <- fread("./datas/IndividualAssignment3_sr3fut.csv")
# start question 4
sr3fut <- fread("./datas/IndividualAssignment3_sr3fut.csv")
sr3fut
Re <- 100 - sr3fut[StartDt == t1]$SettlePrice
sr3fut[StartDt == t1]$SettlePrice
t1 <- as.IDate("2027-12-15")
sr3fut[StartDt == t1]$SettlePrice
Re <- 100 - sr3fut[StartDt == t1]$SettlePrice
SR_init <- sr3fut[StartDt == t1]$SettlePrice
Re <- 100 - SR_init
t0 <- as.Date("2024-01-09")
t1 <- as.IDate("2027-12-15")
t2 <- as.Date("2028-03-15")
sofr = getSymbols('SOFR',src='FRED',auto.assign=FALSE)
sofr = na.omit(sofr)
sofr = as.data.table(sofr)
names(sofr) = c('Date','SOFR')
sofr = na.omit(sofr)
sofr = as.data.table(sofr)
names(sofr) = c('Date','SOFR')
sofr[, SOFR := SOFR/100]
if (!(t1 %in% sofr$Date)){
tmp = data.table(Date = t1, SOFR = NA)
sofr = rbind(sofr,tmp)
}
t0 <- as.IDate("2024-01-09")
t2 <- as.IDate("2028-03-15")
sofr = getSymbols('SOFR',src='FRED',auto.assign=FALSE)
sofr = na.omit(sofr)
sofr = as.data.table(sofr)
names(sofr) = c('Date','SOFR')
sofr[, SOFR := SOFR/100]
if (!(t1 %in% sofr$Date)){
tmp = data.table(Date = t1, SOFR = NA)
sofr = rbind(sofr,tmp)
}
t0 <- as.IDate("2024-01-09")
t1 <- as.IDate("2027-12-15")
t2 <- as.IDate("2028-03-15")
SR_init <- sr3fut[StartDt == t1]$SettlePrice
Re <- 100 - SR_init
sofr = getSymbols('SOFR',src='FRED',auto.assign=FALSE)
sofr = na.omit(sofr)
sofr = as.data.table(sofr)
names(sofr) = c('Date','SOFR')
sofr[, SOFR := SOFR/100]
if (!(t1 %in% sofr$Date)){
tmp = data.table(Date = t1, SOFR = NA)
sofr = rbind(sofr,tmp)
}
sofr
data <- sofr[Date >= t1 & Date <= t2]
data[, di := c(as.numeric(diff(Date)), 0)]
data[, gross_daily_rate := 1 + SOFR*di/360]
data[, cum_prod := cumprod(gross_daily_rate)]
D <- sum(data$di)
R <- (data[(.N -1)]$cum_prod[1] - 1) * 360/D *100
data <- sofr[Date >= t1 & Date <= t2]
data
sofr
class(data$Date)
t0 <- as.Date("2024-01-09")
t1 <- as.Date("2027-12-15")
t2 <- as.Date("2028-03-15")
SR_init <- sr3fut[StartDt == t1]$SettlePrice
Re <- 100 - SR_init
sofr = getSymbols('SOFR',src='FRED',auto.assign=FALSE)
sofr = na.omit(sofr)
sofr = as.data.table(sofr)
names(sofr) = c('Date','SOFR')
sofr[, SOFR := SOFR/100]
data <- sofr[Date >= t1 & Date <= t2]
data[, di := c(as.numeric(diff(Date)), 0)]
data
data <- sofr[Date >= t1 & Date <= t2]
data
sofr$Date - t1
sofr
sr3fut
Re
t0 <- as.Date("2024-01-09")
t1 <- as.Date("2027-12-15")
t2 <- as.Date("2028-03-15")
SR_init <- sr3fut[StartDt == t1]$SettlePrice
SR_init
Re <- 100 - SR_init
Re
# start question 5
t0 <- as.Date("2024-01-09")
t1 <- as.Date("2027-12-15")
t2 <- as.Date("2028-06-21")
sr3fut
Re2 <- sr3fut[StartDt == as.Date("2028-03-15")]$SettlePrice
Re2
Re2 <- 100 - sr3fut[StartDt == as.Date("2028-03-15")]$SettlePrice
Re2
t1.5 <- as.Date("2028-03-15")
data.table(R = c(Re1, Re2),
di = c( t1.5 - t1, t2 - t1.5 ))
Re1 <- Re
Re2 <- 100 - sr3fut[StartDt == as.Date("2028-03-15")]$SettlePrice
data.table(R = c(Re1, Re2),
di = c( t1.5 - t1, t2 - t1.5 ))
data.table(R = c(Re1, Re2),
di = as.numeric(c( t1.5 - t1, t2 - t1.5 )))
data <- data.table(R = c(Re1, Re2),
di = as.numeric(c( t1.5 - t1, t2 - t1.5 )))
data[, gross_daily_rate := 1 + R*di/360]
data
data
data[, cum_prod := cumprod(gross_daily_rate)]
data
data
R <- (data[(.N -1)]$cum_prod[1] - 1) * 360/D *100
data
R
round(SR3_final, 4)
data[, cum_prod := cumprod(gross_daily_rate)]
data
data$cum_prod[.N]
data[.N]$cum_prod
D <- sum(data$di)
data[.N]$cum_prod *360/D *100
data[.N]$cum_prod *360/D
(data[.N]$cum_prod - 1) *360/D
R <- (data[.N]$cum_prod - 1) *360/D
round(R, 4)
initial.twd <- 100
twd.cad <- 0.043
twd.usd <- 0.032
usd.cad <- 1.35
c(initial.twd * twd.cad, initial.twd * twd.usd)
initial.usd <- initial.twd* twd.usd
c(initial.usd * usd.cad)
c(initial.twd * twd.cad, initial.twd * twd.usd)
c(initial.usd * usd.cad)
initial.usd
setwd("E:/MQM_Courses/Term4/FixedIncomeSecurities/FixedIncome_codes/datas")
load("TeamAssignment3_sr3fut_Q1.RData")
setwd("E:/MQM_Courses/Term4/FixedIncomeSecurities/FixedIncome_codes/datas")
load("TeamAssignment3_sr3fut_Q1.RData")
settle <- as.Date("2023-12-29")
library(readr)
library(readr)
setwd("E:/MQM_Courses/Term4/DataVisualization/Assignments")
read_csv("2024-Auction Company Extract_Extract.csv")
setwd("E:/MQM_Courses/Term4/DataVisualization/Assignments")
auction <- read_csv("2024-Auction Company Extract_Extract.csv")
auction
View(auction)
library(data.table)
library(data.table)
auction <- fread("2024-Auction Company Extract_Extract.csv")
names(auction)
table(auction$`Item Industry Name`)
library(tidyverse)
table(auction$`Item Industry Name`) %>% sort(decreasing = TRUE)
names(auction)
auction[, names(auction) %LIKE% "item"]
auction[, names(auction) %like% "item"]
names(auction) %like% "item"
library(stringr)
str_detect(names(auction), 'item')
names(auction) %like% "Item"
auction[,names(auction) %like% "Item"]
auction[names(auction) %like% "Item"]
auction[, names(auction) %like% "Item"]
auction[, names() %like% "Item"]
names(auction) %like% "Item"
auction[names(auction) %like% "Item"]
auction[, names(auction) %like% "Item"]
names(auction) %like% "Item"
auction[, names(auction) %like% "Item", with =FALSE]
item <- auction[, names(auction) %like% "Item", with =FALSE]
View(item)
ncol(item)
ncol(auction)
level(item$`Item Category Name`)
levels(item$`Item Category Name`)
factor(item$`Item Category Name`)
unique(item$`Item Category Name`)
unique(item$`Item Category Name`) %>% count()
unique(item$`Item Category Name`)
unique(item$`Item Category Name`) %>% length()
unique(item$`Item Industry Name`) %>% length()
unique(item$`Item Industry Name`)
unique(item$`Item Make`) %>% length()
unique(item$`Item Make`)
unique(item$`Item Model`) %>% length()
unique(item$`Item Model`)
unique(item$`Item Model`) %>% length()
unique(item$`Item Serial Number`) %>% length()
unique(item$`Item Serial Number`)
unique(item$`Item Model Year`) %>% length()
unique(item$`Item Model Year`)
unique(item$`Item Usage Hours`) %>% length()
unique(item$`Item Usage Hours`)
unique(item$`Item Fee Code`)
unique(item$`Item Fee Description`)
unique(item$`Item Fee Description`) %>% length()
unique(item$`Item Fee Name`) %>% length()
unique(item$`Item Fee Name`)
unique(item$`Item Fee Type`) %>% length()
unique(item$`Item Fee Type`)
unique(item$`Item Fee Type`) %>% length()
unique(item$`Item Fee Amount`) %>% length()
unique(item$`Item Fee Amount`)
table(item$`Item Fee Amount`) %>% sort(decreasing = TRUE)
names(auction)
auction[,"Sold Price"]
auction[, c("Sold Price", "Total Sale")]
auction[, c("Sold Price", "Total Sale", "Item Fee Amount")]
auction[, c("Current Bid", "Sold Price", "Total Sale", "Item Fee Amount")]
sum(auction$`Sold Price` - auction$`Current Bid` != 0)
unique(item$`Item Fee Code`)
unique(item$`Item Fee Description`)
prices <- auction[, c("Current Bid", "Sold Price", "Total Sale", "Item Fee Amount")]
prices[, Gain := `Total Sale` - `Sold Price`]
prices
unique(item$`Item Family Name`)
for (i in 1:ncol(auction)){
if (unique(auction[, i]) == nrow(auction)){
print(names(auction)[i])
}
}
for (name in names(auction)){
if (unique(auction$name) == nrow(auction)){
print(name)
}
}
auction[["Auction Close Time"]]
for (name in names(auction)){
if (unique(auction[[name]]) == nrow(auction)){
print(name)
}
}
unique(auction[["Item Industry Name"]]) == nrow(auction)
for (name in names(auction)){
if (length(unique(auction[[name]])) == nrow(auction)){
print(name)
}
}
uniquesss <- 0
for (name in names(auction)){
if (length(unique(auction[[name]])) > uniquesss){
uniquesss <- length(unique(auction[[name]]))
print(name)
}
}
uniquesss
nrow(auction)
nrow(auction) - uniquesss
table(auction$`Item Unique ID`)
table(auction$`Item Unique ID`)>1
table(auction$`Item Unique ID`)
auction[Item Unique ID == 444688,]
auction[`Item Unique ID` == 444688,]
table(auction$`Item Unique ID`)
install.packages("Rpostgres")
install.packages("RPostgres")
