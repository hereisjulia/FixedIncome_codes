". They spend", round(sum(number_buy_3c*strips_3c$pask) - sum(PV),2), "more than the lottery PV", round(sum(PV),2)))
View(strips_3c)
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
cubic_bidask <- cbind(cubic_bidask, pask = cubic_pask$y)
cubic_bidask$Dept_fund <- cubic_bidask$Amount/100 * cubic_bidask$pask
View(cubic_bidask)
View(cubic_bidask)
#######  3b  #######
cubic_pbid <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pbid,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pask = cubic_pbid$y)
q3b_target <- cubic_bidask[cubic_bidask$Date == "2052-06-30",]
q3b_amount <- optionA_value/q3b_target$Discount/100
q3b_sell <- q3b_amount * q3b_target$pask
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(optionA_value - q3b_sell,2), "lower than the payment PV 79862180."))
strips_3c <- Q2STRIPS_ci[Q2STRIPS_ci$maturity > "2024-02-15" & Q2STRIPS_ci$maturity < "2052-08-30" & month(Q2STRIPS_ci$maturity) == 8,]
PV <- Q3data$Amount * Q3data$Discount
number_buy_3c <- PV/strips_3c$price
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
cubic_bidask <- cbind(cubic_bidask, pask = cubic_pask$y)
View(cubic_bidask)
#######  3b  #######
cubic_pbid <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pbid,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y)
q3b_target <- cubic_bidask[cubic_bidask$Date == "2052-06-30",]
q3b_amount <- optionA_value/q3b_target$Discount/100
q3b_sell <- q3b_amount * q3b_target$pask
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(optionA_value - q3b_sell,2), "lower than the payment PV 79862180."))
strips_3c <- Q2STRIPS_ci[Q2STRIPS_ci$maturity > "2024-02-15" & Q2STRIPS_ci$maturity < "2052-08-30" & month(Q2STRIPS_ci$maturity) == 8,]
PV <- Q3data$Amount * Q3data$Discount
number_buy_3c <- PV/strips_3c$price
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
cubic_bidask <- cbind(cubic_bidask, pask = cubic_pask$y)
View(cubic_bidask)
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
View(cubic_bidask)
cubic_bidask$Dept_fund <- cubic_bidask$Amount * cubic_bidask$Discount
cubic_bidask$Dept_fund <- cubic_bidask$Amount * cubic_bidask$pask
sum(cubic_bidask$Dept_fund)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount * cubic_bidask$Discount
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount * cubic_bidask$Discount
sum(cubic_bidask$Dept_fund)
cubic_bidask$Dept_fund <- cubic_bidask$Amount * cubic_bidask$Discount / cubic_bidask$pask
sum(cubic_bidask$Dept_fund)
View(target)
View(cubic_bidask)
cubic_bidask$Dept_fund <- cubic_bidask$Amount/(cubic_bidask$Amount * cubic_bidask$Discount)
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/(cubic_bidask$Amount * cubic_bidask$Discount)
cubic_bidask$Dept_fund <- cubic_bidask$Dept_fund_unit * cubic_bidask$pask
sum(cubic_bidask$Dept_fund)
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount / cubic_bidask$pask
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount * cubic_bidask$Discount *100
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount * cubic_bidask$Discount *100
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount * cubic_bidask$Discount
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount / cubic_bidask$Discount
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount / cubic_bidask$Discount / 100
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount / cubic_bidask$Discount / 100
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount * cubic_bidask$Discount / 100
View(q3b_target)
#######  3b  #######
cubic_pbid <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pbid,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y)
q3b_target <- cubic_bidask[cubic_bidask$Date == "2052-06-30",]
q3b_amount <- optionA_value*q3b_target$Discount/100
q3b_sell <- q3b_amount * q3b_target$pask
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(optionA_value - q3b_sell,2), "lower than the payment PV 79862180."))
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(optionA_value - q3b_sell,2), "lower than the payment PV 79862180."))
q3b_target <- cubic_bidask[cubic_bidask$Date == "2052-06-30",]
q3b_amount <- optionA_value*q3b_target$Discount/100
q3b_sell <- q3b_amount * q3b_target$pask
q3b_amount <- optionA_value*q3b_target$Discount/100
View(target)
str(q3b_target)
q3b_sell <- q3b_amount * q3b_target$pask
q3b_amount
q3b_amount * q3b_target$pask
q3b_target$pask
q3b_sell <- q3b_amount * q3b_target$pbid
q3b_amount <- optionA_value*q3b_target$Discount/100
q3b_sell <- q3b_amount * q3b_target$pbid
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(optionA_value - q3b_sell,2), "lower than the payment PV 79862180."))
q3b_amount <- optionA_value/q3b_target$Discount/100
q3b_sell <- q3b_amount * q3b_target$pbid
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(optionA_value - q3b_sell,2), "lower than the payment PV 79862180."))
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/cubic_bidask$Discount / 100
#######  3c  #######
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/cubic_bidask$Discount / 100
cubic_bidask$Dept_fund <- cubic_bidask$Dept_fund_unit * cubic_bidask$pask
sum(cubic_bidask$Dept_fund)
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They spend", round(sum(number_buy_3c*strips_3c$pask) - sum(PV),2), "more than the lottery PV", round(sum(PV),2)))
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount / 100
cubic_bidask$Dept_fund <- cubic_bidask$Dept_fund_unit * cubic_bidask$pask
sum(cubic_bidask$Dept_fund)
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They spend", round(sum(number_buy_3c*strips_3c$pask) - sum(PV),2), "more than the lottery PV", round(sum(PV),2)))
optionA_value
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They spend", round(sum(number_buy_3c*strips_3c$pask) - optionA_value,2), "more than the lottery PV", optionA_value))
optionA_value
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They spend", round(sum(cubic_bidask$Dept_fund) - optionA_value,2), "more than the lottery PV", optionA_value))
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They spend", round(sum(cubic_bidask$Dept_fund) - optionA_value,2), "more than the lottery PV", round(optionA_value,2)))
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They will spend", round(sum(cubic_bidask$Dept_fund) - optionA_value,2), "more than the lottery PV", round(optionA_value,2)))
library(readr)
library(ggplot2)
library(lubridate)
library(tidyverse)
library(jrvFinance)
Q2STRIPS <- read_csv("TeamAssignment1_Q2_strips.csv")
Q3data <- read_csv("TeamAssignment1_Q3.csv")
settlement <- as.Date("2023-12-15")
# use the coupon strips for discount rate
Q2STRIPS_ci <- filter(Q2STRIPS, type == "ci")
Q2STRIPS_ci$price <-  (Q2STRIPS_ci$pbid + Q2STRIPS_ci$pask)/2
## Interporation on Discount Factor
Q2STRIPS_ci$discount <- Q2STRIPS_ci$price/100
ttm <- as.numeric((Q2STRIPS_ci$maturity - settlement)/365)
newttm <- as.numeric((Q3data$Date - settlement)/365)
cubic_spline <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$discount,
xout = newttm,
method = "natural"))
Q3data$Discount <- cubic_spline$y
### plot the interporation
names(cubic_spline) <- c("ttm", "discount")
cubic_spline$type <- "interporation"
interporation <- data.frame(
ttm = as.numeric(ttm),
discount = Q2STRIPS_ci$discount,
type = "origin")
interporation <- rbind(interporation,cubic_spline)
ggplot(interporation)+
geom_point(aes(x = ttm, y = discount, color = type))+
labs(title = "Cubic spline on discount factors")+
theme_minimal()
optionA_value <- sum(Q3data$Amount * Q3data$Discount)
optionB_value <- 79000000
print(c(optionA_value, optionB_value))
print(paste("Payout option A has a value of", optionA_value, ".This is higher than 79000000 of option B"))
print(paste("Payout option A has a value of", round(optionA_value,2), ".This is higher than 79000000 of option B"))
#######  3b  #######
cubic_pbid <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pbid,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y)
q3b_target <- cubic_bidask[cubic_bidask$Date == "2052-06-30",]
q3b_amount <- optionA_value/q3b_target$Discount/100
q3b_sell <- q3b_amount * q3b_target$pbid
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(optionA_value - q3b_sell,2), "lower than the payment PV 79862180."))
#######  3c  #######
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/100
cubic_bidask$Dept_fund <- cubic_bidask$Dept_fund_unit * cubic_bidask$pask
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They will spend", round(sum(cubic_bidask$Dept_fund) - optionA_value,2), "more than the lottery PV", round(optionA_value,2)))
##### Q2
bond_data2 <- fread("TeamAssignment1_Q2_bonds.csv")
library(data.table)
library(jrvFinance)
library(jrvFinance)
library(data.table)
library(lubridate)
DATE <- function(yyyy,mm,dd){
date <- as.Date(sprintf("%i-%i-%i",yyyy,mm,dd),format="%Y-%m-%d")
return(date)
}
library(lubridate)
DATE <- function(yyyy,mm,dd){
date <- as.Date(sprintf("%i-%i-%i",yyyy,mm,dd),format="%Y-%m-%d")
return(date)
}
##### Q2
bond_data2 <- fread("TeamAssignment1_Q2_bonds.csv")
bond <- bond_data2[bond_data2$team[11]]
strips_data <- fread("TeamAssignment1_Q2_strips.csv")
bond_data2[, maturity := as.Date(maturity)]
strips_data[, maturity := as.Date(maturity)]
settle <- DATE(2023,12,15)
coupon_quarter <- bond$coupon / 4 * 100
#Cashflows
payment_dates <- strips_data[maturity > settle & maturity <= bond$maturity, maturity]
payment_dates <- sort(unique(payment_dates))
bond_cash_flows <- rep(coupon_quarter, length(payment_dates))
bond_cash_flows <- c(bond_cash_flows, 100)
last_payment_date <- payment_dates[length(payment_dates)]
payment_dates <- c(payment_dates, last_payment_date)
bond_cash_flow_schedule <- data.table(Date = payment_dates, CashFlow = bond_cash_flows)
#arbitrage price
combined_data <- merge(bond_cash_flow_schedule, strips_data[type == "ci"], by.x = "Date", by.y = "maturity")
sp_row <- strips_data[type == "sp" & maturity == combined_data[nrow(combined_data), Date]]
if (nrow(sp_row) == 1) {
combined_data[nrow(combined_data), `:=` (
type = sp_row$type,
pbid = sp_row$pbid,
pask = sp_row$pask
)]
}
arbi_bid <- coupon_quarter * sum(combined_data$pbid[1:(nrow(combined_data)-1)]) / 100 + combined_data$pbid[nrow(combined_data)]
arbi_ask <- coupon_quarter * sum(combined_data$pask[1:(nrow(combined_data)-1)]) / 100 + combined_data$pask[nrow(combined_data)]
arbi_bid <- round(arbi_bid,3)
arbi_ask <- round(arbi_ask,3)
arbi_profit1 <- ifelse(bond$pbid > arbi_ask, "Yes", "No")
arbi_profit2 <- ifelse(bond$pask > arbi_bid, "Yes", "No")
#Answer
print(paste("Buy STRIPS/Sell bond: Pay", arbi_ask, "and Get", bond$pbid, "; Arbitrage profit:", arbi_profit1))
print(paste("Buy bond/Sell STRIPS: Pay", arbi_bid, "and Get", bond$pask, "; Arbitrage profit:", arbi_profit2))
library(data.table)
Q2STRIPS <- fread("TeamAssignment1_Q2_strips.csv")
Q3data <- fread("TeamAssignment1_Q3.csv")
settlement <- as.Date("2023-12-15")
library(readr)
library(ggplot2)
library(lubridate)
library(tidyverse)
library(ggplot2)
library(lubridate)
library(tidyverse)
# use the coupon strips for discount rate
Q2STRIPS_ci <- Q2STRIPS[type == "ci",]
Q2STRIPS <- fread("TeamAssignment1_Q2_strips.csv")
Q3data <- fread("TeamAssignment1_Q3.csv")
settlement <- as.Date("2023-12-15")
# use the coupon strips for discount rate
Q2STRIPS_ci <- Q2STRIPS[type == "ci",]
Q2STRIPS_ci$price <-  (Q2STRIPS_ci$pbid + Q2STRIPS_ci$pask)/2
View(Q2STRIPS_ci)
## Interporation on Discount Factor
Q2STRIPS_ci$discount <- Q2STRIPS_ci$price/100
ttm <- as.numeric((Q2STRIPS_ci$maturity - settlement)/365)
DATE <- function(yyyy,mm,dd){
date <- as.Date(sprintf("%i-%i-%i",yyyy,mm,dd),format="%Y-%m-%d")
return(date)
}
Q2STRIPS_ci$maturity <- DATE(Q2STRIPS_ci$maturity)
library(lubridate)
ttm <- as.numeric((Q2STRIPS_ci$maturity - settlement)/365)
Q2STRIPS <- read_csv("TeamAssignment1_Q2_strips.csv")
Q2STRIPS <- read_csv("TeamAssignment1_Q2_strips.csv")
Q3data <- read_csv("TeamAssignment1_Q3.csv")
settlement <- as.Date("2023-12-15")
# use the coupon strips for discount rate
Q2STRIPS_ci <- filter(Q2STRIPS, type == "ci")
Q2STRIPS_ci$price <-  (Q2STRIPS_ci$pbid + Q2STRIPS_ci$pask)/2
## Interporation on Discount Factor
Q2STRIPS_ci$discount <- Q2STRIPS_ci$price/100
ttm <- as.numeric((Q2STRIPS_ci$maturity - settlement)/365)
newttm <- as.numeric((Q3data$Date - settlement)/365)
cubic_spline <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$discount,
xout = newttm,
method = "natural"))
Q3data$Discount <- cubic_spline$y
## Interporation on spot rate
spot_rate <- function(price, ttm, comp.freq = 4){
ttm <- as.numeric(ttm)
return(comp.freq * ( (100/price)^(1/comp.freq/ttm) - 1 ) )
}
Q2STRIPS_ci$spote_rate <- spot_rate(Q2STRIPS_ci$price, ttm)
View(Q2STRIPS_ci)
cubic_spline2 <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$spote_rate,
xout = newttm,
method = "natural"))
cubic_spline2
Q3data$spote_rate <- cubic_spline2$y
View(Q3data)
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
Q3data$Price <- 100/(1 + Q3data$spote_rate/2)^(2*ttm)
ttm
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
Q3data$Price <- 100/(1 + Q3data$spote_rate/2)^(2*newttm)
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
comp.freq <- 1
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
comp.freq <- 1
Q3data$Price <- Q3data$Amount/(1 + Q3data$spote_rate/comp.freq)^(comp.freq*newttm)
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
comp.freq <- 2
Q3data$Amount/(1 + Q3data$spote_rate/comp.freq)^(comp.freq*newttm)
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
comp.freq <- 1
Q3data$Price <- Q3data$Amount/(1 + Q3data$spote_rate/comp.freq)^(comp.freq*newttm)
q3b_sell <- sum(Q3data$Price)
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(optionA_value - q3b_sell,2), "lower than the payment PV 79862180."))
optionA_value <- sum(Q3data$Amount * Q3data$Discount)
optionB_value <- 79000000
print(c(optionA_value, optionB_value))
print(paste("Payout option A has a value of", round(optionA_value,2), ".This is higher than 79000000 of option B"))
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
comp.freq <- 1
Q3data$Price <- Q3data$Amount/(1 + Q3data$spote_rate/comp.freq)^(comp.freq*newttm)
q3b_sell <- sum(Q3data$Price)
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(optionA_value - q3b_sell,2), "lower than the payment PV 79862180."))
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(q3b_sell - optionA_value,2), "higher than the payment PV 79862180."))
#######  3c  #######
Q3data$Dept_fund
#######  3c  #######
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
Q3data$pask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/100
Q2STRIPS <- read_csv("TeamAssignment1_Q2_strips.csv")
Q3data <- read_csv("TeamAssignment1_Q3.csv")
settlement <- as.Date("2023-12-15")
# use the coupon strips for discount rate
Q2STRIPS_ci <- filter(Q2STRIPS, type == "ci")
Q2STRIPS_ci$price <-  (Q2STRIPS_ci$pbid + Q2STRIPS_ci$pask)/2
## Interporation on Discount Factor
Q2STRIPS_ci$discount <- Q2STRIPS_ci$price/100
ttm <- as.numeric((Q2STRIPS_ci$maturity - settlement)/365)
newttm <- as.numeric((Q3data$Date - settlement)/365)
cubic_spline <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$discount,
xout = newttm,
method = "natural"))
Q3data$Discount <- cubic_spline$y
## Interporation on spot rate
spot_rate <- function(price, ttm, comp.freq = 4){
ttm <- as.numeric(ttm)
return(comp.freq * ( (100/price)^(1/comp.freq/ttm) - 1 ) )
}
Q2STRIPS_ci$spote_rate <- spot_rate(Q2STRIPS_ci$price, ttm)
cubic_spline2 <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$spote_rate,
xout = newttm,
method = "natural"))
Q3data$spote_rate <- cubic_spline2$y
optionA_value <- sum(Q3data$Amount * Q3data$Discount)
optionB_value <- 79000000
print(c(optionA_value, optionB_value))
print(paste("Payout option A has a value of", round(optionA_value,2), ".This is higher than 79000000 of option B"))
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
comp.freq <- 1
Q3data$Price <- Q3data$Amount/(1 + Q3data$spote_rate/comp.freq)^(comp.freq*newttm)
q3b_sell <- sum(Q3data$Price)
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(q3b_sell - optionA_value,2), "higher than the payment PV 79862180."))
#######  3c  #######
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/100
cubic_bidask <- data.frame(Q3data, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/100
cubic_bidask$Dept_fund <- cubic_bidask$Dept_fund_unit * cubic_bidask$pask
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They will spend", round(sum(cubic_bidask$Dept_fund) - optionA_value,2), "more than the lottery PV", round(optionA_value,2)))
### plot the interporation
names(cubic_spline2) <- c("ttm", "discount")
cubic_spline2$type <- "interporation"
interporation2 <- data.frame(
ttm = as.numeric(ttm),
spot_rate = Q2STRIPS_ci$spote_rate,
type = "origin")
interporation2 <- rbind(interporation,cubic_spline)
interporation2 <- rbind(interporation2,cubic_spline)
interporation2 <- rbind(interporation2,cubic_spline2)
View(cubic_spline2)
View(interporation2)
### plot the interporation
names(cubic_spline2) <- c("ttm", "spot_rate")
cubic_spline2$type <- "interporation"
interporation2 <- data.frame(
ttm = as.numeric(ttm),
spot_rate = Q2STRIPS_ci$spote_rate,
type = "origin")
interporation2 <- rbind(interporation2,cubic_spline2)
Q2STRIPS <- read_csv("TeamAssignment1_Q2_strips.csv")
Q3data <- read_csv("TeamAssignment1_Q3.csv")
settlement <- as.Date("2023-12-15")
# use the coupon strips for discount rate
Q2STRIPS_ci <- filter(Q2STRIPS, type == "ci")
Q2STRIPS_ci$price <-  (Q2STRIPS_ci$pbid + Q2STRIPS_ci$pask)/2
## Interporation on Discount Factor
Q2STRIPS_ci$discount <- Q2STRIPS_ci$price/100
ttm <- as.numeric((Q2STRIPS_ci$maturity - settlement)/365)
newttm <- as.numeric((Q3data$Date - settlement)/365)
cubic_spline <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$discount,
xout = newttm,
method = "natural"))
Q3data$Discount <- cubic_spline$y
### plot the interporation
names(cubic_spline) <- c("ttm", "discount")
cubic_spline$type <- "interporation"
interporation <- data.frame(
ttm = as.numeric(ttm),
discount = Q2STRIPS_ci$discount,
type = "origin")
interporation <- rbind(interporation,cubic_spline)
ggplot(interporation)+
geom_point(aes(x = ttm, y = discount, color = type))+
labs(title = "Cubic spline on discount factors")+
theme_minimal()
## Interporation on spot rate
spot_rate <- function(price, ttm, comp.freq = 4){
ttm <- as.numeric(ttm)
return(comp.freq * ( (100/price)^(1/comp.freq/ttm) - 1 ) )
}
Q2STRIPS_ci$spote_rate <- spot_rate(Q2STRIPS_ci$price, ttm)
cubic_spline2 <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$spote_rate,
xout = newttm,
method = "natural"))
Q3data$spote_rate <- cubic_spline2$y
### plot the interporation
names(cubic_spline2) <- c("ttm", "spot_rate")
cubic_spline2$type <- "interporation"
interporation2 <- data.frame(
ttm = as.numeric(ttm),
spot_rate = Q2STRIPS_ci$spote_rate,
type = "origin")
interporation2 <- rbind(interporation2,cubic_spline2)
ggplot(interporation)+
geom_point(aes(x = ttm, y = discount, color = type))+
labs(title = "Cubic spline on discount factors")+
theme_minimal()
ggplot(interporation2)+
geom_point(aes(x = ttm, y = spote_rate, color = type))+
labs(title = "Cubic spline on spote rate")+
theme_minimal()
interporation2 <- data.frame(
ttm = as.numeric(ttm),
spot_rate = Q2STRIPS_ci$spote_rate,
type = "origin")
ggplot(interporation2)+
geom_point(aes(x = ttm, y = spot_rate, color = type))+
labs(title = "Cubic spline on spote rate")+
theme_minimal()
View(interporation2)
View(cubic_spline2)
interporation2 <- rbind(interporation2,cubic_spline2)
ggplot(interporation2)+
geom_point(aes(x = ttm, y = spot_rate, color = type))+
labs(title = "Cubic spline on spote rate")+
theme_minimal()
print(paste("Payout option A has a value of", round(optionA_value,2), ".This is higher than 79000000 of option B"))
optionA_value <- sum(Q3data$Amount * Q3data$Discount)
optionB_value <- 79000000
print(c(optionA_value, optionB_value))
print(paste("Payout option A has a value of", round(optionA_value,2), ".This is higher than 79000000 of option B"))
print(paste("Payout option A has a value of", round(optionA_value,2), ".This is higher than 79000000 of option B"))
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
comp.freq <- 1
Q3data$Price <- Q3data$Amount/(1 + Q3data$spote_rate/comp.freq)^(comp.freq*newttm)
q3b_sell <- sum(Q3data$Price)
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(q3b_sell - optionA_value,2), "higher than the payment PV 79862180."))
#######  3c  #######
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/100
cubic_bidask$Dept_fund <- cubic_bidask$Dept_fund_unit * cubic_bidask$pask
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They will spend", round(sum(cubic_bidask$Dept_fund) - optionA_value,2), "more than the lottery PV", round(optionA_value,2)))
View(Q3data)
Q3data[,c(1,4,5)]
Q3data[,c(1,4,5)] %>% View()
View(cubic_bidask)
cubic_bidask[,c(1,5:8)] %>% View()
