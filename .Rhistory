#######  3c  #######
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pbid = cubic_pbid$y, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/100
cubic_bidask <- data.frame(Q3data, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/100
cubic_bidask$Dept_fund <- cubic_bidask$Dept_fund_unit * cubic_bidask$pask
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They will spend", round(sum(cubic_bidask$Dept_fund) - optionA_value,2), "more than the lottery PV", round(optionA_value,2)))
### plot the interporation
names(cubic_spline2) <- c("ttm", "discount")
cubic_spline2$type <- "interporation"
interporation2 <- data.frame(
ttm = as.numeric(ttm),
spot_rate = Q2STRIPS_ci$spote_rate,
type = "origin")
interporation2 <- rbind(interporation,cubic_spline)
interporation2 <- rbind(interporation2,cubic_spline)
interporation2 <- rbind(interporation2,cubic_spline2)
View(cubic_spline2)
View(interporation2)
### plot the interporation
names(cubic_spline2) <- c("ttm", "spot_rate")
cubic_spline2$type <- "interporation"
interporation2 <- data.frame(
ttm = as.numeric(ttm),
spot_rate = Q2STRIPS_ci$spote_rate,
type = "origin")
interporation2 <- rbind(interporation2,cubic_spline2)
Q2STRIPS <- read_csv("TeamAssignment1_Q2_strips.csv")
Q3data <- read_csv("TeamAssignment1_Q3.csv")
settlement <- as.Date("2023-12-15")
# use the coupon strips for discount rate
Q2STRIPS_ci <- filter(Q2STRIPS, type == "ci")
Q2STRIPS_ci$price <-  (Q2STRIPS_ci$pbid + Q2STRIPS_ci$pask)/2
## Interporation on Discount Factor
Q2STRIPS_ci$discount <- Q2STRIPS_ci$price/100
ttm <- as.numeric((Q2STRIPS_ci$maturity - settlement)/365)
newttm <- as.numeric((Q3data$Date - settlement)/365)
cubic_spline <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$discount,
xout = newttm,
method = "natural"))
Q3data$Discount <- cubic_spline$y
### plot the interporation
names(cubic_spline) <- c("ttm", "discount")
cubic_spline$type <- "interporation"
interporation <- data.frame(
ttm = as.numeric(ttm),
discount = Q2STRIPS_ci$discount,
type = "origin")
interporation <- rbind(interporation,cubic_spline)
ggplot(interporation)+
geom_point(aes(x = ttm, y = discount, color = type))+
labs(title = "Cubic spline on discount factors")+
theme_minimal()
## Interporation on spot rate
spot_rate <- function(price, ttm, comp.freq = 4){
ttm <- as.numeric(ttm)
return(comp.freq * ( (100/price)^(1/comp.freq/ttm) - 1 ) )
}
Q2STRIPS_ci$spote_rate <- spot_rate(Q2STRIPS_ci$price, ttm)
cubic_spline2 <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$spote_rate,
xout = newttm,
method = "natural"))
Q3data$spote_rate <- cubic_spline2$y
### plot the interporation
names(cubic_spline2) <- c("ttm", "spot_rate")
cubic_spline2$type <- "interporation"
interporation2 <- data.frame(
ttm = as.numeric(ttm),
spot_rate = Q2STRIPS_ci$spote_rate,
type = "origin")
interporation2 <- rbind(interporation2,cubic_spline2)
ggplot(interporation)+
geom_point(aes(x = ttm, y = discount, color = type))+
labs(title = "Cubic spline on discount factors")+
theme_minimal()
ggplot(interporation2)+
geom_point(aes(x = ttm, y = spote_rate, color = type))+
labs(title = "Cubic spline on spote rate")+
theme_minimal()
interporation2 <- data.frame(
ttm = as.numeric(ttm),
spot_rate = Q2STRIPS_ci$spote_rate,
type = "origin")
ggplot(interporation2)+
geom_point(aes(x = ttm, y = spot_rate, color = type))+
labs(title = "Cubic spline on spote rate")+
theme_minimal()
View(interporation2)
View(cubic_spline2)
interporation2 <- rbind(interporation2,cubic_spline2)
ggplot(interporation2)+
geom_point(aes(x = ttm, y = spot_rate, color = type))+
labs(title = "Cubic spline on spote rate")+
theme_minimal()
print(paste("Payout option A has a value of", round(optionA_value,2), ".This is higher than 79000000 of option B"))
optionA_value <- sum(Q3data$Amount * Q3data$Discount)
optionB_value <- 79000000
print(c(optionA_value, optionB_value))
print(paste("Payout option A has a value of", round(optionA_value,2), ".This is higher than 79000000 of option B"))
print(paste("Payout option A has a value of", round(optionA_value,2), ".This is higher than 79000000 of option B"))
#######  3b  #######
# we can use the spot rate to get the price of the STRIPS of each lottery payments
comp.freq <- 1
Q3data$Price <- Q3data$Amount/(1 + Q3data$spote_rate/comp.freq)^(comp.freq*newttm)
q3b_sell <- sum(Q3data$Price)
print(paste("the lottery winner receive", round(q3b_sell,2), "from selling coupon STRIPS.", "This is", round(q3b_sell - optionA_value,2), "higher than the payment PV 79862180."))
#######  3c  #######
cubic_pask <- as.data.frame(spline(as.numeric(ttm),
Q2STRIPS_ci$pask,
xout = newttm,
method = "natural"))
cubic_bidask <- data.frame(Q3data, pask = cubic_pask$y)
cubic_bidask$Dept_fund_unit <- cubic_bidask$Amount/100
cubic_bidask$Dept_fund <- cubic_bidask$Dept_fund_unit * cubic_bidask$pask
print(paste("The payment department need to fund:", round(sum(cubic_bidask$Dept_fund),2),
". They will spend", round(sum(cubic_bidask$Dept_fund) - optionA_value,2), "more than the lottery PV", round(optionA_value,2)))
View(Q3data)
Q3data[,c(1,4,5)]
Q3data[,c(1,4,5)] %>% View()
View(cubic_bidask)
cubic_bidask[,c(1,5:8)] %>% View()
library(data.table)
library(data.table)
library(data.table)
# start question 1
maturity <- as.Date("2024-10-03")
BDR <- 0.04745
# start question 1
settle <- as.Date("2023-12-15")
d <- as.numeric(maturity-settle)
100 * ( 1 - BDR * d/360)
round(100 * ( 1 - BDR * d/360))
# start question 2
maturity2 <- as.Date("2052-05-15")
coupon <- 0.02875
coupon <- 0.02875
maturity2 <- as.Date("2052-05-15")
# start question 2
settle <- as.Date("2023-12-15")
fread("IndividualAssignment02-ci.csv")
CI <- fread("IndividualAssignment02-ci.csv")
SP <- fread("IndividualAssignment02-sp.csv")
View(CI)
View(SP)
library(jrvFinance)
library(jrvFinance)
bond.yield(settle, maturity2, coupon, 2, CI$price, "ACT/ACT", 2)
bond.yield(settle, maturity2, coupon, 2, CI$price, "ACT/ACT", 2)
bond.yield(settle, maturity2, coupon, 2, CI$price[1], "ACT/ACT", 2)
bond.TCF(settle, maturity2, coupon, 2, 2)
bond.TCF(settle, maturity2, coupon, 2, 2)
# start question 2
settle <- as.Date("2023-12-15")
maturity2 <- as.Date("2052-05-15")
coupon <- 0.02875
CI <- fread("IndividualAssignment02-ci.csv")
SP <- fread("IndividualAssignment02-sp.csv")
bond.TCF(settle, maturity2, coupon, 2, 2)
bond.TCF(settle, maturity2, coupon, 2, "ACT/ACT")
bond.TCF(settle, maturity2, coupon, 2, "ACT/ACT")$cf
coupons.dates(settle, maturity2, 2)
CI[coupons.dates(settle, maturity2, 2),]
CI[coupons.dates(settle, maturity2, 2)]
str(CI)
str(coupons.dates(settle, maturity2, 2))
CI[maturity == coupons.dates(settle, maturity2, 2)]
CI[maturity %in% coupons.dates(settle, maturity2, 2)]
cis_2 <- CI[maturity %in% coupons.dates(settle, maturity2, 2)]
bond.TCF(settle, maturity2, coupon, 2, "ACT/ACT")$cf
View(cis_2)
bond.TCF(settle, maturity2, coupon, 2, "ACT/ACT")$cf * cis_2[,2]
bond.TCF(settle, maturity2, coupon, 2, "ACT/ACT")$cf * cis_2[,2] /100
sum(bond.TCF(settle, maturity2, coupon, 2, "ACT/ACT")$cf * cis_2[,2] /100)
bond.TCF(settle, maturity2, coupon, 2, "ACT/ACT")$cf
freq <- 2
cis_2[,2] * 100/coupon/freq
cis_2[,2] * coupon/freq
coupon/freq
View(cis_2)
sum(cis_2[,2] * coupon/freq)
sum(cis_2[,2] * coupon/freq) + SP[maturity == maturity2]
sum(cis_2[,2] * coupon/freq) + SP[maturity == maturity2,2]
bond.TCF(settle, maturity2, coupon, freq, freq)$accrued
bond.TCF(settle, maturity2, coupon, freq, "ACT/ACT")$accrued
sum(cis_2[,2] * coupon/freq) + SP[maturity == maturity2,2] - accint
accint <- bond.TCF(settle, maturity2, coupon, freq, "ACT/ACT")$accrued
sum(cis_2[,2] * coupon/freq) + SP[maturity == maturity2,2] - accint
cis_2 <- CI[maturity %in% coupons.dates(settle, maturity2, 2)]
sum(cis_2[,2] * coupon/freq) + SP[maturity == maturity2,2]
# start question 3
settle <- as.Date("2023-12-15")
maturity3 <- as.Date("2053-02-15")
face <- 10000000
coupon3 <- 0.03625
cleanP <- 92.2190
haircut <- 0.02
reporate <- 0.0531
freq <- 2
bond.TCF(settle, maturity3, coupon3, freq, "ACT/ACT")
bond.TCF(settle, maturity3, coupon3, freq, "ACT/ACT")$accrued
fullP <- cleanP + bond.TCF(settle, maturity3, coupon3, freq, "ACT/ACT")$accrued
Value_of_position <- fullP*face
repo_amount <- Value_of_position * (1 - haircut)
oneDay_repoint <- repo_amount * reporate * 1/360
oneDay_repoint
fullP <- cleanP + bond.TCF(settle, maturity3, coupon3, freq, "ACT/ACT")$accrued
Value_of_position <- fullP/100 *face
repo_amount <- Value_of_position * (1 - haircut)
oneDay_repoint <- repo_amount * reporate * 1/360
oneDay_repoint
6325610 * 0.02
repoint <- repo_amount * reporate * 1/360
repoint
round(repoint,2)
# start question 4
data.table(`Payment Date` = c("2024-05-15", "2025-05-15","2026-05-15","2027-05-15","2028-05-15"))
# start question 4
data.table(`Payment Date` = c("2024-05-15", "2025-05-15","2026-05-15","2027-05-15","2028-05-15"),
`Payment Amount` = 100000)
# start question 4
pension_payment <-  data.table(`Payment Date` = c("2024-05-15", "2025-05-15","2026-05-15","2027-05-15","2028-05-15"),
`Payment Amount` = 100000)
CI[maturity %in% pension_payment$`Payment Date`,]
CI[maturity %in% pension_payment$`Payment Date`,2]/100 * pension_payment$`Payment Amount`
pension_payment_PV <- CI[maturity %in% pension_payment$`Payment Date`,2]/100 * pension_payment$`Payment Amount`
SUM(pension_payment_PV)
sum(pension_payment_PV)
round(repoint,2)
# start question 5
pension_payment2 <-  data.table(`Payment Date` = c("2024-06-30", "2025-06-30","2026-06-30","2027-06-30","2028-06-30"),
`Payment Amount` = 100000)
pension_payment2
ttm <- as.numeric(CI$maturity - settle)
CI$maturity - settle
diff.Date(CI$maturity, settle)
ttm <- as.numeric(CI$maturity - as.IDate(settle))
ttm
as.IDate(settle)
CI$maturity
zcb.yield(CI$price, ttm, comp.freq = 4)
zcb.yield <- function(zcb.price,ttm,comp.freq=2) {
return( comp.freq * ( (100/zcb.price)^(1/(comp.freq*ttm)) - 1 ) )
}
zcb.yield(CI$price, ttm, comp.freq = 4)
CI$spot_rate <- zcb.yield(CI$price, ttm, comp.freq = 4)
?spline()
newttm <- as.numeric(pension_payment2$`Payment Date` - as.IDate(settle))
newttm <- as.numeric(pension_payment2$`Payment Date` - settle)
str(pension_payment2)
pension_payment2$`Payment Date` <- as.Date(pension_payment2$`Payment Date`)
pension_payment2$`Payment Date` - settle
newttm <- as.numeric(pension_payment2$`Payment Date` - settle)
spline(ttm, CI$spot_rate, xout = newttm, method = "natural")
pension_payment2$spot_rate <- spline(ttm, CI$spot_rate, xout = newttm, method = "natural")$y
View(pension_payment2)
zcb.price <- function(zcb.yield,ttm,comp.freq=2) {
return( 100/(1+zcb.yield/comp.freq)^(comp.freq*ttm) )
}
zcb.price(pension_payment2$spot_rate, newttm, comp.freq = 1)
pension_payment2$price <- zcb.price(pension_payment2$spot_rate, newttm, comp.freq = 1)
pension_payment2$PV <- pension_payment2$`Payment Amount`*pension_payment2$price /100
sum(pension_payment2$PV)
round(sum(pension_payment2$PV),2)
round(sum(pension_payment2$PV))
CI$spot_rate <- zcb.yield(CI$price, ttm, comp.freq = 2)
newttm <- as.numeric(pension_payment2$`Payment Date` - settle)
pension_payment2$spot_rate <- spline(ttm, CI$spot_rate, xout = newttm, method = "natural")$y
pension_payment2$price <- zcb.price(pension_payment2$spot_rate, newttm, comp.freq = 1)
pension_payment2$PV <- pension_payment2$`Payment Amount`*pension_payment2$price /100
round(sum(pension_payment2$PV))
pension_payment2$price <- zcb.price(pension_payment2$spot_rate, newttm, comp.freq = 2)
pension_payment2$PV <- pension_payment2$`Payment Amount`*pension_payment2$price /100
round(sum(pension_payment2$PV))
CI$spot_rate <- zcb.yield(CI$price, ttm, comp.freq = 4)
newttm <- as.numeric(pension_payment2$`Payment Date` - settle)
pension_payment2$spot_rate <- spline(ttm, CI$spot_rate, xout = newttm, method = "natural")$y
pension_payment2$price <- zcb.price(pension_payment2$spot_rate, newttm, comp.freq = 2)
pension_payment2$PV <- pension_payment2$`Payment Amount`*pension_payment2$price /100
pension_payment2$price <- zcb.price(pension_payment2$spot_rate, newttm, comp.freq = 1)
pension_payment2$PV <- pension_payment2$`Payment Amount`*pension_payment2$price /100
round(sum(pension_payment2$PV))
pension_payment2$price <- zcb.price(pension_payment2$spot_rate, newttm, comp.freq = 4)
pension_payment2$PV <- pension_payment2$`Payment Amount`*pension_payment2$price /100
round(sum(pension_payment2$PV))
# start question 2
CI <- fread("IndividualAssignment02-ci.csv")
SP <- fread("IndividualAssignment02-sp.csv")
settle <- as.Date("2023-12-15")
maturity2 <- as.Date("2052-05-15")
coupon <- 0.02875
freq <- 2
cis_2 <- CI[maturity %in% coupons.dates(settle, maturity2, 2)]
sum(cis_2[,2] * coupon/freq) + SP[maturity == maturity2,2]
accint <- bond.TCF(settle, maturity2, coupon, freq, "ACT/ACT")$accrued
sum(cis_2[,2] * coupon/freq) + SP[maturity == maturity2,2] - accint
zcb.yield <- function(zcb.price,ttm,comp.freq=2) {
return( comp.freq * ( (100/zcb.price)^(1/(comp.freq*ttm)) - 1 ) )
}
CI$spot_rate <- zcb.yield(CI$price, ttm, comp.freq = 4)
View(cis_2)
cis_2 <- CI[maturity %in% coupons.dates(settle, maturity2, 2)]
sum(cis_2[,2] * coupon/freq) + SP[maturity == maturity2,2] - accint
accint <- bond.TCF(settle, maturity2, coupon, freq, "ACT/ACT")$accrued
sum(cis_2[1:56,2] * coupon/freq) + SP[maturity == maturity2,2] - accint
accint <- bond.TCF(settle, maturity2, coupon, freq, "ACT/ACT")$accrued
accint <- bond.TCF(settle, maturity2, coupon, freq, "ACT/ACT")$accrued
sum(cis_2[1:56,2] * coupon/freq) + SP[maturity == maturity2,2] - accint
?irr
irr(bond.TCF(settle, maturity3, coupon3, freq, "ACT/ACT")$cf)
irr(bond.TCF(settle, maturity3, coupon3, freq, "ACT/ACT")$cf, cf.freq = 2,comp.freq = 2, method ="default")
bond.TCF(settle, maturity3, coupon3, freq, "ACT/ACT")$cf
# start question 1
settle <- as.Date("2023-12-15")
maturity <- as.Date("2024-10-03")
BDR <- 0.04745
d <- as.numeric(maturity-settle)
round(100 * ( 1 - BDR * d/360))
# start question 3
settle <- as.Date("2023-12-15")
maturity3 <- as.Date("2053-02-15")
face <- 10000000
coupon3 <- 0.03625
cleanP <- 92.2190
haircut <- 0.02
reporate <- 0.0531
freq <- 2
fullP <- cleanP + bond.TCF(settle, maturity3, coupon3, freq, "ACT/ACT")$accrued
Value_of_position <- fullP/100 *face
repo_amount <- Value_of_position * (1 - haircut)
repoint <- repo_amount * reporate * 1/360
round(repoint,2)
bond.TCF(settle,maturity2,coupon)
settle <- as.Date("2023-12-15")
maturity2 <- as.Date("2052-05-15")
coupon <- 0.02875
freq <- 2
bond.TCF(settle,maturity2,coupon)
coupons.dates(settle, maturity2)
coupons.dates(settle, maturity2, freq)
bond.TCF(settle,maturity2,coupon,freq)
coupons.dates(settle, maturity2, freq)
bond.TCF(settle,maturity2,coupon,freq)
CI[maturity %in% coupons.dates(settle, maturity2, freq)]
# start question 2
CI <- fread("IndividualAssignment02-ci.csv")
SP <- fread("IndividualAssignment02-sp.csv")
CI[maturity %in% coupons.dates(settle, maturity2, freq)]
Discount <- CI[maturity %in% coupons.dates(settle, maturity2, freq)]$price
Discount <- CI[maturity %in% coupons.dates(settle, maturity2, freq)]$price /100
TCF <- bond.TCF(settle,maturity2,coupon,freq)
View(SP)
View(CI)
TCF$cf
TCF$cf[57]
TCF$cf[57] <- TCF$cf[57]-100
TCF
TCF * Discount
Discount
class(TCF$cf)
class(Discount)
TCF$cf * Discount
SP[maturity == maturity2]
SP[maturity == maturity2][,2]
TCF$cf * Discount + SP[maturity == maturity2][,2]
TCF$cf * Discount + SP[maturity == maturity2][,2]
TCF$cf * Discount
sum(TCF$cf * Discount) + SP[maturity == maturity2][,2]
sum(TCF$cf * Discount) + SP[maturity == maturity2][,2] - TCF$accrued
settle <- as.Date("2023-12-15")
coupon <- 0.02875
freq <- 2
maturity2 <- as.Date("2052-05-15")
Discount <- CI[maturity %in% coupons.dates(settle, maturity2, freq)]$price /100
coupons.dates(settle, maturity2, freq)
TCF <- bond.TCF(settle,maturity2,coupon,freq)
TCF
sum(TCF$cf * Discount) + SP[maturity == maturity2][,2] - TCF$accrued
# start question 2
CI <- fread("IndividualAssignment02-ci.csv")
SP <- fread("IndividualAssignment02-sp.csv")
settle <- as.Date("2023-12-15")
coupon <- 0.02875
freq <- 2
maturity2 <- as.Date("2052-05-15")
Discount <- CI[maturity %in% coupons.dates(settle, maturity2, freq)]$price /100
TCF <- bond.TCF(settle,maturity2,coupon,freq)
TCF$cf[57] <- TCF$cf[57]-100
sum(TCF$cf * Discount) + SP[maturity == maturity2][,2] - TCF$accrued
CI$spot_rate <- zcb.yield(CI$price, ttm, comp.freq = 4)
zcb.yield <- function(zcb.price,ttm,comp.freq=2) {
return( comp.freq * ( (100/zcb.price)^(1/(comp.freq*ttm)) - 1 ) )
}
CI$spot_rate <- zcb.yield(CI$price, ttm, comp.freq = 4)
# start question 5
settle <- as.Date("2023-12-15")
pension_payment2 <-  data.table(`Payment Date` = c("2024-06-30", "2025-06-30","2026-06-30","2027-06-30","2028-06-30"),
`Payment Amount` = 100000)
pension_payment2$`Payment Date` <- as.Date(pension_payment2$`Payment Date`)
zcb.yield <- function(zcb.price,ttm,comp.freq=2) {
return( comp.freq * ( (100/zcb.price)^(1/(comp.freq*ttm)) - 1 ) )
}
CI$spot_rate <- zcb.yield(CI$price, ttm, comp.freq = 4)
ttm <- as.numeric(CI$maturity - as.IDate(settle))
CI$spot_rate <- zcb.yield(CI$price, ttm, comp.freq = 4)
View(CI)
View(CI)
irr(TCF$cf, cf.freq = 2, comp.freq = 2)
cashflows <- c(-1000, 200, 300, 400, 500)
class(cashflows)
class(TCF$cf)
irr(c(0,TCF$cf), cf.freq = 2, comp.freq = 2)
irr(c(-100,TCF$cf), cf.freq = 2, comp.freq = 2)
TCF$cf
TCF <- bond.TCF(settle,maturity2,coupon,freq)
irr(c(-100,TCF$cf), cf.freq = 2, comp.freq = 2)
R <- irr(c(-100,TCF$cf), cf.freq = 2, comp.freq = 2)
?bond.price
bond.price(settle,maturity2,coupon,freq,R,"ACT/ACT")
cashflows <- c(-100, 1.125, 1.125,1.125,101.125)
irr(cashflows, 2,2)
irr(cashflows, cf.freq = 2, comp.freq = 2))
irr(cashflows, cf.freq = 2, comp.freq = 2)
R <- irr(c(-100,TCF$cf), cf.freq = 2, comp.freq = 2)*2
bond.price(settle,maturity2,coupon,freq,R,"ACT/ACT")
R <- irr(c(-100,TCF$cf), cf.freq = 2, comp.freq = 2)
bond.price(settle,maturity2,coupon,freq,R,"ACT/ACT")
TCF <- bond.TCF(settle,maturity2,coupon,freq)
settle <- as.Date("2023-12-15")
maturity2 <- as.Date("2052-05-15")
coupon <- 0.02875
freq <- 2
Discount <- CI[maturity %in% coupons.dates(settle, maturity2, freq)]$price /100
TCF <- bond.TCF(settle,maturity2,coupon,freq)
TCF$cf[57] <- TCF$cf[57]-100
sum(TCF$cf * Discount) + SP[maturity == maturity2][,2] - TCF$accrued
settle <- as.Date("2023-12-15")
maturity2 <- as.Date("2052-05-15")
coupon <- 0.02875
freq <- 2
?irr
irr(c(-100, TCF$cf), freq = 2, comp.freq =2)
irr(c(-100, TCF$cf), cf.freq = freq, comp.freq =freq)
TCF <- bond.TCF(settle,maturity2,coupon,freq)
irr(c(-100, TCF$cf), cf.freq = freq, comp.freq =freq)
R< <- irr(c(-100, TCF$cf), cf.freq = freq, comp.freq =freq)
R <- irr(c(-100, TCF$cf), cf.freq = freq, comp.freq =freq)
row(TCF)
nrow(TCF$cf)
coupons.dates(settle, maturity2, freq)
library(tidyverse)
DSC <- as.Date("2024-05-15") - settle %>% as.numeric()
coupons.dates(settle, maturity2, freq)
E <- as.Date("2024-05-15") - as.Date("2023-11-15") %>% as.numeric()
for (i in 1:length(TCF$cf)){
PV[i] <- TCF$cf[i] / (1+R/freq) ^ (i-1+DSC/E)
}
class(DSC)
DSC <- as.numeric(as.Date("2024-05-15") - settle %>% as.numeric())
E <- as.numeric(as.Date("2024-05-15") - as.Date("2023-11-15"))
for (i in 1:length(TCF$cf)){
PV[i] <- TCF$cf[i] / (1+R/freq) ^ (i-1+DSC/E)
}
PV <- NA
for (i in 1:length(TCF$cf)){
PV[i] <- TCF$cf[i] / (1+R/freq) ^ (i-1+DSC/E)
}
sum(PV)
PV
TCF$cf[57] <- TCF$cf[57]-100
PV <- NA
for (i in 1:length(TCF$cf)){
PV[i] <- TCF$cf[i] / (1+R/freq) ^ (i-1+DSC/E)
}
sum(PV)
length(PV)
sum(PV) + 100/(1+R/freq) ^ (length(PV)-1 + DSC/E)
sum(PV) + 100/(1+R/freq) ^ (length(PV)-1 + DSC/E) - TCF$accrued
TFC$cf
TCF$cf
###########################old###############################
Discount <- CI[maturity %in% coupons.dates(settle, maturity2, freq)]$price /100
TCF <- bond.TCF(settle,maturity2,coupon,freq)
TCF$cf[57] <- TCF$cf[57]-100
sum(TCF$cf * Discount) + SP[maturity == maturity2][,2] - TCF$accrued
1000000 * ( 1 - BDR * d/360)
library(jrvFinance)
library(jrvFinance)
library(data.table)
library(data.table)
library(dplyr)
library(dplyr)
library(lubridate)
library(readr)
library(readr)
library(ggplot2)
library(tidyverse)
DATE <- function(yyyy,mm,dd) {
dte  <- as.Date(sprintf("%i-%i-%i",yyyy,mm,dd),format="%Y-%m-%d")
return(dte)
}
as.Date2 <- function(x) {
tryfmt <- c("%Y-%m-%d","%m/%d/%Y","%Y/%m/%d","%b %d,%Y")
return(as.Date(x,tryFormats=tryfmt))
}
bond_data <- fread("TeamAssignment1_Q1.csv")
