install.packages("jrvFinance")
library(jrvFinance)
library(jrvFinance)
library(readxl)
library(readxl)
funds <- read_excel("E:/MQM_Courses/AllCase/DataCompetition/Funds Dashboard_OptimizingRisk/Fund List and Performance.xlsx")
View(funds)
names(funds)
names(funds %like% "Ret")
names(funds)[ %like% "Ret"]
names(funds)[%like% "Ret"]
library(stringr)
str_detect(names(funds), "Ret")
funds[str_detect(names(funds), "Ret")]
return <- cbind(funds$Name, funds[str_detect(names(funds), "Ret")])
return
?rename()
return <- cbind(funds$Name, funds[str_detect(names(funds), "Ret")])[-7]
names(return) <- c("Name", "1", "3", "6","12","36")
return
?melt()
library(tidyverse)
?melt()
?pivot_longer
pivot_longer(return, cols = -1, names_to = month, values_to = return)
pivot_longer(return, cols = -1, names_to = "month", values_to = "return")
return <- pivot_longer(return, cols = -1, names_to = "month", values_to = "return")
library(writexl)
library(writexl)
?write
write_xlsx(return, path = "fund_return.xlsx")
write_xlsx(return, path = "fund_return.xlsx")
write_xlsx(return, path = "./fund_return.xlsx")
write_xlsx(return, path = "E:/MQM_Courses/AllCase/DataCompetition/Funds Dashboard_OptimizingRisk/fund_return.xlsx")
neams(funds)
names(funds)
arrange(funds, desc(Tot Ret 1Y))
arrange(funds, desc("Tot Ret 1Y"))
funds <- arrange(funds, desc("Tot Ret 1Y"))
funds <- read_excel("E:/MQM_Courses/AllCase/DataCompetition/Funds Dashboard_OptimizingRisk/Fund List and Performance.xlsx")
View(funds)
funds <- arrange(funds, desc(`Tot Ret 1Y`))
View(funds)
# longer the types
return <- cbind(funds$Name, funds[str_detect(names(funds), "Focus")], funds$`Fund Strategy`)
#save the name, return only
return <- cbind(funds$Name, funds[str_detect(names(funds), "Ret")])[-7]
names(return) <- c("Name", "1", "3", "6","12","36")
return <- pivot_longer(return, cols = -1, names_to = "month", values_to = "return")
View(types)
# longer the types
types <- cbind(funds$Name, funds[str_detect(names(funds), "Focus")], funds$`Fund Strategy`)
View(types)
# longer the types
types <- cbind(Name = funds$Name, funds[str_detect(names(funds), "Focus")], Strategy = funds$`Fund Strategy`)
types <- pivot_longer(types, cols = -1, names_to = "type". values_to = "content")
types <- pivot_longer(types, cols = -1, names_to = "type", values_to = "content")
write_xlsx(types, path = "E:/MQM_Courses/AllCase/DataCompetition/Funds Dashboard_OptimizingRisk/fund_types.xlsx")
nrow(funds)
